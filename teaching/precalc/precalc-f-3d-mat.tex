\section{Matrices in 3D}

\emph{Problems and solutions can be found at \url{https://azhou5849.github.io/teaching/}}

\subsection{Review Problems}

Throughout this section, let
\begin{align*}
\mathsf{A} &= \begin{pmatrix} 3 & 3 & 0 \\ 2 & -1 & 2 \\ 3 & 2 & 3 \end{pmatrix}, & \mathsf{B} &= \begin{pmatrix} 2 & 2 & -1 \\ -3 & 3 & -3 \\ -3 & -1 & 1 \end{pmatrix}, & \mathsf{U} &= \begin{pmatrix} -3 & -2 & 0 \\ 0 & -1 & -1 \\ 0 & 0 & 2 \end{pmatrix}, \\
\vec{u} &= \begin{pmatrix} 5 \\ 4 \\ 0 \end{pmatrix}, & \vec{v} &= \begin{pmatrix} 0 \\ -1 \\ 1 \end{pmatrix}, & \vec{w} &= \begin{pmatrix} -7 \\ -3 \\ 8 \end{pmatrix}.
\end{align*}

\begin{enumerate}
\item \emph{Matrix-vector calculations.}
\begin{enumerate}
\item Compute $\mathsf{A}\vec{u}$, $\mathsf{B}\vec{u}$, $\mathsf{U}\vec{u}$, $\mathsf{A}\vec{v}$, and $\mathsf{B}\vec{w}$.
\item Compute $2(\mathsf{A}\vec{u}) + 3(\mathsf{A}\vec{v})$ and $\mathsf{A}(2\vec{u} + 3\vec{v})$.
\item How does $\mathsf{B}\vec{w}$ relate to $\vec{w}$? Use this to compute $\mathsf{B}^5\vec{w}$.
\end{enumerate}
\item \emph{Matrix-matrix calculations.}
\begin{enumerate}
\item Compute $3\mathsf{A}$ and $\mathsf{B} - \mathsf{U}$.
\item Compute $(3\mathsf{A} + \mathsf{B} - \mathsf{U})\vec{v}$ and $3(\mathsf{A}\vec{v}) + \mathsf{B}\vec{v} - \mathsf{U}\vec{v}$.
\item Find all triples $(r,s,t)$ of real numbers such that $r\mathsf{A} + s\mathsf{B} + t\mathsf{U} = \mathsf{0}$.
\end{enumerate}
\item \emph{Matrix products.}
\begin{enumerate}
\item Compute $\mathsf{AB}$, $\mathsf{BA}$, and $\mathsf{AU}$.
\item Compute $\mathsf{AB} + \mathsf{AU}$ and $\mathsf{A}(\mathsf{B} + \mathsf{U})$.
\item Compute $(\mathsf{AB})\mathsf{U}$ and $\mathsf{A}(\mathsf{BU})$.
\end{enumerate}
\item \emph{Geometric transformations.}
\begin{enumerate}
\item Compute the matrix for scaling the $x$ and $y$ coordinates by $3/2$.
\item Compute the matrix for projecting onto $\vec{w}$.
\item Compute the matrix for reflecting across the plane $2x + 2y + 3z = 0$.
\item Compute the matrix for rotating around the $z$-axis with the property that $(-3,4,-12)$ is rotated to $(0,5,-12)$.
\item ($*$) Compute the matrix for rotating by an angle of $\pi$ around the axis passing through the origin and the point $(-3,4,-12)$.
\end{enumerate}
\newpage
\item \emph{Determinants.}
\begin{enumerate}
\item Compute $\det\mathsf{A}$, $\det\mathsf{B}$, and $\det\mathsf{U}$.
\item Compute $\det(\mathsf{AB})$ and $(\det\mathsf{A})(\det\mathsf{B})$.
\end{enumerate}
\item \emph{Inverses.}
\begin{enumerate}
\item Compute the inverses of $\mathsf{A}$ and $\mathsf{U}$.
\item Show that $\mathsf{B} - 4\mathsf{I}$ is not invertible.
\item Identify a non-zero vector $\vec{x}$ with the property that $(\mathsf{B} - 4\mathsf{I})\vec{x} = \vec{0}$.
\end{enumerate}
\item \emph{Cross products and matrices.} Given a matrix $\mathsf{M}$, let $[\mathsf{M}]_{ij}$ denote the entry in the $i$-th row and $j$-th column. Recall that the \textbf{transpose} of $\mathsf{M}$ is the matrix $\mathsf{M}^T$ with the property that $[\mathsf{M}^T]_{ij} = [\mathsf{M}]_{ji}$, i.e. the rows of $\mathsf{M}^T$ are the columns of $\mathsf{M}$ and vice-versa. A square matrix $\mathsf{M}$ is called \textbf{symmetric} if $\mathsf{M}^T = \mathsf{M}$ and \textbf{skew-symmetric} if $\mathsf{M}^T = -\mathsf{M}$.
\begin{enumerate}
\item Show that for every vector $\vec{a}$, there is a corresponding skew-symmetric matrix $\mathsf{R}_{\vec{a}}$ such that $\mathsf{R}_{\vec{a}}\vec{x} = \vec{a}\times\vec{x}$ for all vectors $\vec{x}$.
\item Conversely, show that for every skew-symmetric matrix $\mathsf{M}$, there is a corresponding vector $\vec{a}_{\mathsf{M}}$ for which $\mathsf{M}\vec{x} = \vec{a}_{\mathsf{M}}\times\vec{x}$ for all vectors $\vec{x}$.
\item Show that $\mathsf{R}_{\vec{a}\times\vec{b}} = \mathsf{R}_{\vec{a}}\mathsf{R}_{\vec{b}} - \mathsf{R}_{\vec{b}}\mathsf{R}_{\vec{a}}$.
\item Independently of the previous parts, show that every square matrix $\mathsf{M}$ can be written as the sum of a symmetric matrix and a skew-symmetric matrix.
\end{enumerate}
\end{enumerate}


\newpage
\subsection{Challenge Problems}

The results in this section are stated for $\mathbb{R}^3$ and for $3\times 3$ matrices, but they generalise directly to any (finite) dimension.

\begin{enumerate}\setcounter{enumi}{7}
\item In general, if $\mathsf{A}$ is an $\ell\times m$ matrix and $\mathsf{B}$ is an $m\times n$ matrix, then $\mathsf{AB}$ is an $\ell\times n$ matrix. For $1\leq i\leq\ell$ and $1\leq j\leq n$, the entry of $\mathsf{AB}$ in row $i$ and column $j$ is found by taking the ``dot product'' of the $i$-th row of $\mathsf{A}$ with the $j$-th column of $\mathsf{B}$. This also applies to matrix-vector multiplication if we regard an $m$-component vector as an $m\times 1$ matrix.
\begin{enumerate}
\item Describe the matrices $\begin{pmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \end{pmatrix}$ and $\begin{pmatrix} 1 & 0 \\ 0 & 1 \\ 0 & 0 \end{pmatrix}$ geometrically.
\item Let $\vec{u}\in\mathbb{R}^3$ be a vector of norm 1. Show that projection onto the line generated by $\vec{u}$ is given by the matrix $\vec{uu}^T$.
\item Let $\vec{u},\vec{v}\in\mathbb{R}^3$ be vectors of norm 1 which are orthogonal to each other, and let $\mathsf{Q}$ be the matrix whose columns are $\vec{u}$ and $\vec{v}$. Show that projection onto the plane generated by $\vec{u}$ and $\vec{v}$ is given by the matrix $\mathsf{QQ}^T$.
\item More generally, let $\vec{u},\vec{v}\in\mathbb{R}^3$ be any two linearly independent vectors and let $\mathsf{A}$ be the matrix whose columns are $\vec{u}$ and $\vec{v}$. Derive a formula in terms of $\mathsf{A}$ for the matrix that represents projection onto the plane generated by $\vec{u}$ and $\vec{v}$.
\end{enumerate}
\item Let $\mathsf{A}$ be a $3\times 3$ matrix. For each pair of indices $1\leq i,j\leq 3$, the $(i,j)$-th \textbf{minor} $\mathsf{M}_{ij}$ of $\mathsf{A}$ is the determinant of the $2\times 2$ matrix formed by deleting the $i$-th row and $j$-th column of $\mathsf{A}$. The \textbf{adjugate matrix} of $\mathsf{A}$ is the $3\times 3$ matrix $\adj\mathsf{A}$ whose $(i,j)$-th entry is $(-1)^{i + j}M_{ji}$.
\begin{enumerate}
\item Show that $\mathsf{A}(\adj\mathsf{A}) = (\adj\mathsf{A})\mathsf{A} = (\det\mathsf{A})\mathsf{I}$.
\item Supposing $\det\mathsf{A}\neq 0$, express $\mathsf{A}^{-1}$ in terms of $\adj\mathsf{A}$ and $\det\mathsf{A}$.
\end{enumerate}
\item Fix a matrix $\mathsf{A} = \begin{pmatrix} a_{11} & a_{12} & a_{13} \\ a_{21} & a_{22} & a_{23} \\ a_{31} & a_{32} & a_{33} \end{pmatrix}$. Given any polynomial $f(X) = b_0 + b_1X + \cdots + b_nX^n$, we can define scalar multiplication of a vector by a polynomial according to the formula
\begin{equation*}
f(X)\vec{v} = (b_0\mathsf{I} + b_1\mathsf{A} + b_2\mathsf{A}^2 + \cdots + b_n\mathsf{A}^n)\vec{v}.
\end{equation*}
\begin{enumerate}
\item Show that
\begin{equation*}
\begin{pmatrix} a_{11} - X & a_{12} & a_{13} \\ a_{21} & a_{22} - X & a_{23} \\ a_{31} & a_{32} & a_{33} - X \end{pmatrix}\begin{pmatrix} \unit{i} \\ \unit{j} \\ \unit{k} \end{pmatrix} = \begin{pmatrix} \vec{0} \\ \vec{0} \\ \vec{0} \end{pmatrix}.
\end{equation*}
\item Show that $p_{\mathsf{A}}(X) = \det(\mathsf{A} - X\mathsf{I})$, the \textbf{characteristic polynomial} of $\mathsf{A}$, satisfies the relation $p_{\mathsf{A}}(X)\vec{v} = \vec{0}$ for all vectors $\vec{v}$.
\item Supposing $p_{\mathsf{A}}(X) = c_0 + c_1X + c_2X^2 + c_3X^3$, show that $c_0\mathsf{I} + c_1\mathsf{A} + c_2\mathsf{A}^2 + c_3\mathsf{A}^3 = \mathsf{0}$. This is the \textbf{Cayley-Hamilton theorem} ($3\times 3$ case), sometimes written as $p_{\mathsf{A}}(\mathsf{A}) = \mathsf{0}$.
\end{enumerate}
\end{enumerate}


\newpage
\subsection{Answers}

\begin{enumerate}
\item \begin{enumerate}
\item \begin{multicols}{2}
$\mathsf{A}\vec{u} = \begin{pmatrix} 27 \\ 6 \\ 23 \end{pmatrix}$\par
$\mathsf{B}\vec{u} = \begin{pmatrix} 18 \\ -3 \\ -19 \end{pmatrix}$\par
$\mathsf{U}\vec{u} = \begin{pmatrix} -23 \\ -4 \\ 0 \end{pmatrix}$\par
$\mathsf{A}\vec{v} = \begin{pmatrix} -3 \\ 3 \\ 1 \end{pmatrix}$\par
$\mathsf{B}\vec{w} = \begin{pmatrix} -28 \\ -12 \\ 32 \end{pmatrix}$
\end{multicols}
\item The two computations should give the same result, as
\begin{equation*}
\mathsf{A}(2\vec{u} + 3\vec{v}) = \mathsf{A}(2\vec{u}) + \mathsf{A}(3\vec{v}) = 2(\mathsf{A}\vec{u}) + 3(\mathsf{A}\vec{v}).
\end{equation*}
From what we computed in part (a),
\begin{equation*}
2(\mathsf{A}\vec{u}) + 3(\mathsf{A}\vec{v}) = 2\begin{pmatrix} 27 \\ 6 \\ 23 \end{pmatrix} + 3\begin{pmatrix} -3 \\ 3 \\ 1 \end{pmatrix} = \begin{pmatrix} 45 \\ 21 \\ 49 \end{pmatrix}.
\end{equation*}
\item We observe that $\mathsf{B}\vec{w} = 4\vec{w}$. Therefore,
\begin{equation*}
\mathsf{B}^5\vec{w} = 4^5\vec{w} = 1024\begin{pmatrix} -7 \\ -3 \\ 8 \end{pmatrix} = \begin{pmatrix} -7168 \\ -3072 \\ 8192 \end{pmatrix}.
\end{equation*}
\end{enumerate}
\item \begin{enumerate}
\item \begin{multicols}{2}
$3\mathsf{A} = \begin{pmatrix} 9 & 9 & 0 \\ 6 & -3 & 6 \\ 9 & 6 & 9 \end{pmatrix}$\par
$\mathsf{B} - \mathsf{U} = \begin{pmatrix} 5 & 4 & -1 \\ -3 & 4 & -2 \\ -3 & -1 & -1 \end{pmatrix}$
\end{multicols}
\item The two computations should give the same result, as
\begin{equation*}
(3\mathsf{A} + \mathsf{B} - \mathsf{U})\vec{v} = (3\mathsf{A})\vec{v} + \mathsf{B}\vec{v} - \mathsf{U}\vec{v} = 3(\mathsf{A}\vec{v}) + \mathsf{B}\vec{v} - \mathsf{U}\vec{v}.
\end{equation*}
From what we computed in part (a),
\begin{equation*}
3\mathsf{A} + \mathsf{B} - \mathsf{U} = \begin{pmatrix} 14 & 13 & -1 \\ 3 & 1 & 4 \\ 6 & 5 & 8 \end{pmatrix},
\end{equation*}
so then
\begin{equation*}
(3\mathsf{A} + \mathsf{B} - \mathsf{U})\vec{v} = \begin{pmatrix} 14 & 13 & -1 \\ 3 & 1 & 4 \\ 6 & 5 & 8 \end{pmatrix}\begin{pmatrix} 0 \\ -1 \\ 1 \end{pmatrix} = \begin{pmatrix} -14 \\ 3 \\ 3 \end{pmatrix}.
\end{equation*}
\item The upper right entry of $\mathsf{M} = r\mathsf{A} + s\mathsf{B} + t\mathsf{U} = \mathsf{0}$ is $-s$, so we need $s = 0$. Then, the lower left entry of $\mathsf{M} = r\mathsf{A} + t\mathsf{U} = \mathsf{0}$ is $3r$, so we need $r = 0$. Finally, $\mathsf{M} = t\mathsf{U} = \mathsf{0}$ forces $t = 0$, so the only solution is $(r,s,t) = (0,0,0)$.
\end{enumerate}
\item \begin{enumerate}
\item $\mathsf{AB} = \begin{pmatrix} -3 & 15 & -12 \\ 1 & -1 & 3 \\ -9 & 9 & -6 \end{pmatrix}$\par
$\mathsf{BA} = \begin{pmatrix} 7 & 2 & 1 \\ -12 & -18 & -3 \\ -8 & -6 & 1 \end{pmatrix}$\par
$\mathsf{AU} = \begin{pmatrix} -9 & -9 & -3 \\ -6 & -3 & 5 \\ -9 & -8 & 4 \end{pmatrix}$
\item 
\end{enumerate}
\end{enumerate}